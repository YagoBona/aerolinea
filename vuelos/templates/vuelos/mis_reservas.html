{% extends 'vuelos/base.html' %}
{% load i18n %}
{% block contenido %}
<h2 class="mb-4" style="color:#ff9800; font-weight:700; letter-spacing:1px;"><i class="bi bi-ticket-perforated"></i> {% trans "Mis Reservas" %}</h2>
{% if reservas %}
  <div class="row g-3">
    {% for r in reservas %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card shadow-sm h-100" style="border:2px solid #ff9800; border-radius:18px;">
          <div class="card-body">
            <div class="d-flex align-items-center mb-2">
              <i class="bi bi-airplane" style="color:#ff9800; font-size:1.5rem;"></i>
              <span class="ms-2" style="font-weight:600; font-size:1.1rem;">{{ r.vuelo.origen }} → {{ r.vuelo.destino }}</span>
            </div>
            <div class="mb-1"><i class="bi bi-calendar-event" style="color:#ff9800;"></i> <span style="color:#888;">{% trans "Fecha:" %}</span> <strong>{{ r.vuelo.fecha_salida|date:"d/m/Y H:i" }}</strong></div>
            <div class="mb-1"><i class="bi bi-grid-3x3-gap" style="color:#ff9800;"></i> <span style="color:#888;">{% trans "Asiento:" %}</span> <strong>{{ r.asiento.numero }}</strong></div>
            <div class="mb-1"><i class="bi bi-hash" style="color:#ff9800;"></i> <span style="color:#888;">{% trans "Código:" %}</span> <strong>{{ r.codigo_reserva }}</strong></div>
            <div class="mb-2">
              {% if r.estado == 'cancelada' %}
                <span class="badge bg-danger">{% trans "Cancelada" %}</span>
              {% elif r.vuelo.fecha_salida < today %}
                <span class="badge bg-secondary">{% trans "Vencida" %}</span>
              {% else %}
                <span class="badge bg-success">{% trans "Próxima" %}</span>
              {% endif %}
            </div>
            <div class="d-flex flex-wrap gap-2 mt-2">
              {% if r.boleto %}
                <a href="{% url 'ver_boleto' r.codigo_reserva %}" class="btn btn-outline-primary btn-sm rounded-pill"><i class="bi bi-ticket-detailed"></i> {% trans "Ver boleto" %}</a>
                <a href="{% url 'imprimir_boleto' r.codigo_reserva %}" class="btn btn-success btn-sm rounded-pill"><i class="bi bi-printer"></i> {% trans "Imprimir/Descargar" %}</a>
              {% else %}
                <span class="text-danger">{% trans "Boleto no generado" %}</span>
              {% endif %}
              {% if r.estado != 'cancelada' %}
                <form action="{% url 'cancelar_reserva' r.id %}" method="post" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-danger btn-sm rounded-pill"><i class="bi bi-x-circle"></i> {% trans "Cancelar" %}</button>
                </form>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">No tenés reservas todavía.</p>
{% endif %}
{% endblock %}
